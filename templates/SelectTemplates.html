<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"> <!--防止移动端缩放-->
    <title></title>

    <style type="text/css">

        .loading {
            width: 250px;
            height: 56px;
            position: absolute;
            top: 50%;
            left: 50%;
            margin: -28px 0px 0px -125px;
            line-height: 56px;
            color: #fff;
            padding-left: 60px;
            font-size: 12px;
            background: #000 url(../static/imgs/waiting.gif) no-repeat 10px 50%;
            opacity: 0.7;
            z-index: 9999;
            -moz-border-radius: 20px;
            -webkit-border-radius: 20px;
            border-radius: 20px;
            filter: progid:DXImageTransform.Microsoft.Alpha(opacity=70);
        }
            </style>

    <!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
    <!--jQuery cdn链接-->
    <script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/popper.js/1.15.0/umd/popper.min.js"></script>
    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
</head>
<body>
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <fieldset class="layui-elem-field" style="text-align: center;">
                <legend>议程表助手</legend>
            </fieldset>

            <form>
                <div class="form-group">
                    <!-- <label for="exampleInputEmail1">Email address</label> -->
                    <select id="templateSelect" class="form-control  input-lg">
                        <option value="">请选择模板</option>
                        <option value="jabil_jouse_template_for_print">捷普聚思模板</option>
                        <option value="huangpu_rise_template_for_print">黄埔睿思模板</option>
                    </select>
                </div>
                <div class="form-group">
                    <center><button type="button" id="submitButton" class="btn btn-primary btn-lg btn-block">下一步</button></center>
                </div>
                <script>
                    // 加载页面时向后端获取可选模板名称
                    // $(document).ready(function(){
                    //     $.post("./list_templates", function(returnData){
                    //         let templateName_Arr = returnData.template_names;
                    //         if(templateName_Arr.length > 0){
                    //             //模板名的数量大于0，渲染到下拉框内
                    //             let SelectInput = $("#templateSelect");
                    //             for(let i = 0;i < templateName_Arr.length;i++){
                    //                 // SelectInput.append("<option value='"+templateName_Arr[i]+"'>"+templateName_Arr[i]+"</option>");
                    //             }
                    //         }
                    //     })
                    // })

                    const templateSelect = document.getElementById("templateSelect");
                    const submitButton = document.getElementById("submitButton");
                
                    submitButton.addEventListener("click", function() {
                    MaskUtil.mask();

                    const selectedTemplate = templateSelect.value;
                    const formData = new FormData();
                    formData.append("selected_template", selectedTemplate);
                    
                    fetch("./set_selected_template", {
                        method: "POST",
                        body: formData
                    })
                    .then(response => {
                        console.log(response); // Add this line to check the response
                        
                        if (response.ok) {
                            return response.json(); // Assuming the response is in JSON format
                        } else {
                            throw new Error("Error: " + response.status);
                        }
                    })
                    .then(data => {
                        // Handle the response data here
                        console.log(data);
                        // Redirect to the desired location after successful response
                        window.location = "./InputAgendaContent";
                    })
                    .catch(error => {
                        // Handle any errors that occurred during the request
                        console.error("Error:", error);
                    });
                });


/**
 * 说明：数据进行加载时的遮罩层，基于bootstrap的页面模态框做封装处理
 * 使用方法:
 * 开启:MaskUtil.mask();
 * 关闭:MaskUtil.unmask();
 */
var MaskUtil = (function(){
    var $mask,$maskMsg;
    var defMsg = '跳转中，请稍等。。。';
    function init(){
        if(!$mask){
            $mask = $("<div id=\"myWaitingModal\" class=\"modal fade\" data-keyboard=\"false\" data-backdrop=\"static\" data-role=\"dialog\" " +
                "aria-labelledby=\"myWaitingModalLabel\" aria-hidden=\"true\">" +
                "<div id=\"loading\" class=\"loading\"><span class=\"spinner-border\" role=\"status\"></span>"+
                    "<span>&nbsp;&nbsp;"+defMsg+"</span></div></div>").appendTo("body");
        }
    }
    return {
        mask:function(){
            init();
            $('#myWaitingModal').modal('show');
        }
        ,unmask:function(){
            $('#myWaitingModal').modal('hide');
            $mask = null;
            $('#myWaitingModal').remove();
            $('.modal-backdrop').hide();
        }
    }
}());
                </script>
            </form>
        </div>
    </div>

</div>

<!-- <div class="layui-col-md12" style="text-align: center;">
        <fieldset class="layui-elem-field">
            <legend>请选择模板</legend>
        </fieldset>
    </div>
    <div class="layui-col-md12">
        <form action="./list_templates" class="layui-form layui-form-pane" lay-filter="selectTemplet" method="post">
            <div class="layui-form-item">
                <label class="layui-form-label">选择模板</label>
                <div class="layui-input-block">
                    <select id="Select_Templets" name="user_name"></select>
                    <input type="text" name="user_name" value="123"/>
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-input-block">
                    <input type="button" onclick="PostMessage" class="layui-btn layui-btn-normal layui-btn-fluid" id="btn_Next" value="下一步" />
                    <button type="submit">下一步</button>
                </div>
            </div>
        </form>
    </div> -->

    <script type="text/javascript">
        // layui.use(['form'], function(){
        //     var form = layui.form;
        //     var $ = layui.$;

            

            
        // })
        // $("#btn_Next").click(function(){
        //         $.ajax({
        //         url: "/list_templates",
        //         type: "Post",
        //         dataType: "json",
        //         data:{UserName: "Taam"},
        //         success: function(returnData){
        //             console.log(returnData);
        //         }
        //     })
        //     })

        function PostMessage(){

        }
    </script>
</body>
</html>